---
title: "Lab5"
author: "SpicyBois"
date: "9/29/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load tidyverse
library(tidyverse)

# Load and view the data
milk <- read.csv('state_milk_production.csv')
head(milk)

milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)
```

# Assignment Details
## Individually
  1) For the first, display the distribution of the yearly milk production (in millions of pounds) for your birth-year. 
  2) Summarise the data for your birth year. Mean, median, max (add amount), min (add amount).
  
## Team
  1) Select all of the states in which at least one of your group members has lived in. If there are less than 5, choose additional states so that you select 5 of them. For these states, plot a yearly time series for the milk production (in millions of pounds). On this plot, display a line showing the average milk produced each year for all states.
  2) The year when the most milk was produced in the United States.
  3) The year when the least milk was produced in the United States.
  4) In 2017, report the 5 states that produced the most milk. (Hint: Use arrange)
  5) In 2017, report the 5 states that produced the least milk. (Hint: Use arrange)


# Distribution of Milk Production for our Birth Year.
# Distribution of Milk Production for our Birth Year (Individual)

## Distribution of the Yearly Milk Production for 1997 (Tyler)

```{r}
milk1997 <- milk %>%
  filter(year == 1997)

ggplot(data = milk1997, mapping = aes(x = milk_million)) +
         geom_density() +
         theme_bw() +
         labs(title = "Distribution of milk produced in 1997 by state", x = "Milk Produced in millions", y = "Density")

milkSummary1997 <- milk1997 %>%
  select(state, milk_million) %>%
  group_by(state) %>%
  summarise(Average = mean(milk_million), Median = median(milk_million), Maximum = max(milk_million), Minimum = min(milk_million)) %>%
  as_tibble

milkSummary1997

```

## Distribution of the Yearly Milk Production for 1998 (Trent)
```{r}
milk1998 <- milk %>%
  filter(year == 1998)

ggplot(data = milk1998, aes(x = milk_million)) +
  geom_histogram(bins = 15) + 
  theme_light()+
  labs(title = "Distribution estimate of milk produced in 1998 by state", x = "Milk Produced (millions of milk pounds)", y = "Count (states)")
```
```{r}
milkcor98 <- milk %>% select(state, year, milk_million) %>% group_by(state) %>%
  summarise(Average = mean(milk_million), Median = median(milk_million), Max = max(milk_million), Min = min(milk_million)) %>%
  as_tibble()
milkcor98
```

## Distribution of the prodcution of milk by state for the year 1999 (Joe)
```{r}
milk99 <- milk %>%
  filter( year == 1999)
ggplot(data = milk99, aes(milk_million)) +
  geom_density()+
  ggtitle('Distribution estimate of milk produced in 1999') +
  theme_get()+
  xlab('Millions of pounds of milk produced') +
  ylab('Density of production')

Average <- milk99 %>% group_by(state) %>% summarise(AVERAGE = mean(milk_million))
Median <- milk99 %>% group_by(state) %>% summarise(MEDIAN = median(milk_million))
Max <- milk99 %>% group_by(state) %>% arrange(desc(milk_million))
Min <- milk99 %>% group_by(state) %>% arrange(milk_million)

Average
Median
Max
Min
```

## The Distribution of the yearly milk production for 2000. (Logan)
```{r}
milk2000 <- milk %>% filter(year == 2000)
ggplot(data = milk2000, aes(x = milk_million)) + 
  geom_density() + 
  scale_x_continuous(breaks = seq(0, 45000, 2000)) +
  labs(title = 'Distribution estimate of milk produced in 2000', x = "Milk Produced (Million lb)", y = "Density")

milk2000.median = milk2000 %>% summarise(me = median(milk_million))
milk2000.mean = milk2000 %>% summarise(avg = mean(milk_million))
milk2000.max = milk2000 %>% summarise(max = max(milk_million)) #California
milk2000.min = milk2000 %>% summarise(max = min(milk_million)) #Alaska
```

**Findings:** In the year 2000, the mediam was 1.4535 billion pounds of milk. The average amount of milk produced was 3.334784 billion pounds of milk per state. California produced the most amount of milk, producing 32.245 billion pounds of milk. Alaska produced the least amount of milk, with only 13 million pounds of milk. 

# Distribution of Milk Production for our State.

## Yearly Time Series for the Milk Production for Georgia (Jack)
```{r}
milkGA <- milk %>%
  filter(state %in% c('Georgia'))

ggplot(data = milkGA, aes(x = year, y = milk_million)) +
  geom_point() + 
  ggtitle('Pounds of milk over time in California') +
  geom_smooth(method= "lm", na.rm = TRUE, se = FALSE) +
  labs(x = 'Year', y = 'Milk Produced (Million lb)') 
```

**Findings: ** This plot has some very interesting trends. There tends to be many ups and downs for Georgia's milk production throughout the years. Although there has been an overall increase in the amount of milk produced per year, there are several dips in the graph. One of those dips being between 1985-1999, and another being 2005-2011. I know there was a significant drought in Georgia during the time period of 2005-2011 which could be a possible confounding variable.

## Yearly Time Series for the Milk Production for Wisconsin (Trent)
```{r}
milkWIS <- milk %>%
  filter(state %in% c('Wisconsin')) %>%
  select(state, year, milk_million)

ggplot(data = milkWIS, aes(x = year, y = milk_million, color = state)) +
  geom_point() + 
  ggtitle('Pounds of milk over time in Wisconsin') +
  geom_smooth(method= "lm", na.rm = TRUE, se = FALSE) +
  xlab('Year') +
  ylab('Milk Produced (Million lb)')
```

**Findings: ** This plot displays some interesting findings, predominantly the decline in milk production from the late 80's to the mid 2000's, followed by a sharp increase of milk production that we currently see. One of Wisconsin's biggest exports is dairy products, so it is slightly puzzling for there to be such a significant dip.

## Yearly Time Series for the Milk Production for California (Logan)
```{r}
milkCal <- milk %>%
  filter(state %in% c('California'))

ggplot(data = milkCal, aes(x = year, y = milk_million)) +
  geom_point() + 
  ggtitle('Pounds of milk over time in California') +
  geom_smooth(method= "lm", na.rm = TRUE, se = FALSE) +
  labs(x = 'Year', y = 'Milk Produced (Million lb)') + 
  scale_x_continuous(breaks = seq(1970, 2017, 4))
```

**Findings:** The plot above shows that California is constatly increasing between the years 1970 - 2008. In 2009 it is seen that there is a drop in milk production. After 2009, milk production is on the raise again until, 2014, were it seems that milk production is starting to decrease gradualy. 

## Yearly Time Series for the Milk Production for Colorado (Tyler)
```{r}
milkCo <- milk %>%
  filter(state %in% c('Colorado'))

ggplot(data = milkCo, mapping = aes(x = year, y = milk_million)) +
  geom_point() +
  ggtitle('Pounds of milk over time in Colorado') +
  geom_smooth(method = "lm", na.rm = TRUE, se = FALSE) +
  xlab('Year') +
  ylab('Milk Produced in Millions')

```
**Findings** The plot shows that as the years go on that more and more milk was produced in Colorado. One year in particular, 2008, had a big surge in milk production. The years following had the production of milk decrease until 2011 where it started to rise again. For this plot, a linear model does not best fit the graph, a exponential fit would be better.  

## Milk Production in New Mexico over Time (Joe)
```{r}
MexMilk <- milk %>% filter(state %in% c('New Mexico'))

ggplot(data = MexMilk, aes(x= year, y= milk_million)) +
  geom_point()+
  geom_smooth(method= "lm", na.rm = TRUE, se = FALSE) +
  ggtitle('Production of Milk in New Mexico') +
  ylab('Millions of Pounds of Milk Produced') +
  xlab('Year')

```
**Findings** This plot shows a very consistent upward trend in milk production since 1970. There is a huge abnormality in 2008, most likely due to the 2008 Housing Market crash, but besides that one abnormal change in growth, the graph is very steady. I found that for this reason, the linear model fits the graph well.

## Yearly Time Series for the Milk Production for Georgia (Jack)

```{r}
milkGA <- milk %>%
  filter(state %in% c('Georgia'))

ggplot(data = milkGA, aes(x = year, y = milk_million)) +
  geom_point() +
  labs(title = "Pounds of milk over time in Georgia", x = "Year", y = "Milk Produced (Million lb") +
  geom_smooth(method = "lm", na.rm = TRUE, se = FALSE)

```

**Findings:** THis plot has some very interesting trends. There tends to be many ups and downs for Georgia's milk production throughout the years. Although there has been an overall increase in teh amount of mike produced per year, there are serveral dips in the graph. One of those dips being between 1985-1999, and anther being 2005-2011. I know there was a significant drought in Georgia during the time perios and 2005-20011 wich could be a possivle confounding varibale. 

## Milk production for Colorado, Georgia, New Mexico, California, Wisconsin. (TEAM)
```{r}
milkAvg <- milk %>% group_by(year) %>% summarise(avg = mean(milk_produced), avg_million = mean(milk_million))
milkAvg <- unname(milkAvg)

milkState <- milk
for (row in 1:nrow(milkAvg)) {
  myYear <- milkAvg[row, 1]
  myAvg <- milkAvg[row, 2]
  myAvg_million <- milkAvg[row, 3]
  
  milkState <- rbind(milkState, data.frame(region = 'Average', state = 'Average', year = myYear, milk_produced = myAvg, milk_million = myAvg_million))
}

milksub <- milkState %>%
  filter(state %in% c('Colorado','Georgia','New Mexico','California','Wisconsin', 'Average')) %>%
  select(state, year, milk_million)

ggplot(data = milksub, aes(x = year, y = milk_million, color = state)) +
  geom_point() +
  labs(title = 'Pounds of milk over time by state', x = 'Year', y = 'Milk Produced (Million lb)')
```

# Stats for Milk production in United States.

## What year did the most amount of milk produced in the United States. (TEAM)
```{r}
milkTotal <- milk %>% 
  group_by(year) %>%
  summarise(count = sum(milk_produced), count_million = sum(milk_million))

ggplot(data = milkTotal, aes(x = year, y = count_million)) + geom_col() + labs(title = "Total amount of Milk Produced Each year", x = "Year", y = "Total Milk Produced (Million lb)")
milkTotal %>% arrange(desc(count_million))
```

**Findings:** The year when the least amount of milk was prduced in the United States was 2017.

## The year when the least milk was produced in the United States. (TEAM)
```{r}
milkTotal <- milk %>% 
  group_by(year) %>%
  summarise(count = sum(milk_produced), count_million = sum(milk_million))

ggplot(data = milkTotal, aes(x = year, y = count_million)) + geom_col() + labs(title = "Total amount of Milk Produced Each year", x = "Year", y = "Total Milk Produced (Million lb)")
milkTotal %>% arrange(count_million)
```

**Findings:** The year when the least amount of milk was prduced in the United States was 1975.

## In 2017, report the 5 states that produced the most milk. (TEAM)
```{r}

```

**Findings:** 

## In 2017, report the 5 states that produced the least milk. (TEAM)
```{r}

```

**Findings:** 

# Team Reports
**Trent:** I created the plot for the milk production in Wisconsin, as well as the data set for my birth year, 1998. I used the filter function to isolate just the 1998 data, and used a histogram to display the milk produced between all states. For the Wisconsin data, I used the filter function to isolate just Wisconsin's data, and used the geometric point function to graph the findings. I also typed out the ethical discussion our group had about the findings from this data.

**Logan:** I created the plot for the milk prodcution stats for the year 2000 (my birth year). To do this I used the filter function, to filter out all years exept year 2000. Using this data I created a density plot for milk produced between all states. I then used the summerize mean, mediam, max, min functions to indetify the state that produced the most and least amount of milk, as well as how much most states produce, and the average amount of milk produced per state. I created the graph for the yearly production in California, (I have never lived their, but we needed more states). To create this graph I used filiter function to single out Califonia, then used a point graph to show the total milk produced for each year. I also used a smooth function to show the general trend of what the data is doing with the increase in year. I also created the graph for the year when the most amount of milk was produced in the United States.

**Jack:**

**Joe:** I created the plot for the milk production of the year I was born, 1999. I utilized the filter function to isolate the data that I wanted to work with, then used the density graph to show a general distribution of the aggregate milk production of all US states. I used the summarise function to find the Average and Median values of milk production separated by state. I also used the Arrange function to get an ascending and descending list of milk production. This makes the data extremely accessibly and easy to draw conclusions from. I also generated a graph for the yearly production of milk from New Mexico. I used a simple point graph and a line to match its general trend.

**Tyler:** I created the plot for the prodection of states milk in 1997(not my birth year, but didn't want to do repeat graphs). For this I used the filter funtion to get the pecific yeat I wanted, and then used a density plot to report the findings. I also created the plot for the state of Colorado's milk production over the years. To do this plot I filtered again, but this time to Colorado, and used a geom point plot to show the exact amount of milk produced per year, and then a smooth plot to get the overall trend of the data. Finally I found what states produced the most and least amount of milk in 2017. To do this I filtered by the year 2017 and grouped the data by state. Then I sumarised the data for a sum of all the milk produced by state and printed out the table in descending order and ascending order.

# Ethics of this data analysis.
The one major take away from this data is the steady rise of milk production across the United States, which means more and more dairy farms would need to have a larger stock of cows to produce the milk. This large demand of milk can lead to severe mistreatment of live stock, and higher demands could lead to worse conditions for the animals. So while humans may benefit from enjoying the wide variety of dairy products from the milk production industry, we must be mindful of the animals who make the milk, and treat them as ethically as possible.