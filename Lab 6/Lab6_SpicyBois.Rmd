---
title: "Lab6"
author: "Logan Richards"
date: "10/1/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
COflights <- read_csv("https://files.osf.io/v1/resources/3z5as4pej8/providers/osfstorage/5a8ca28f57103100104584db")
DENflights <- COflights %>% filter(ORIGIN == "DEN" | DEST == "DEN")
```

# What Factors Lead to On-time Arrivals in Denver?

```{r}
(DENflights)
```


#Studies from Individual Members

##Probability Flights will be Delayed based on Weather (Tyler)
```{r}
DENdelay <- DENflights %>% filter(ARR_DELAY >= 15) %>% mutate(DELAY_WEATHER = (WEATHER_DELAY >= 15))

ggplot(data = DENdelay) +  geom_bar(mapping = aes(x = ARR_DELAY, binwidth = 500)) + facet_wrap(.~DELAY_WEATHER) + coord_cartesian(xlim = c(0, 500))

```


##Probabilities Flights will be Delayed Based on Season (Trent)
```{r}
ggplot(DENflights) + geom_point(aes(ARR_DELAY, MONTH)) +
  theme_bw() +
  scale_y_continuous(breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), 
                     labels = c("JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG",
                                "SEP", "OCT", "NOV", "DEC"))+
  labs(title = 'Total time of delay by Month',
       x='Total time of departure delay',
       y='Month')
```
```{r}
DENflights <- DENflights %>% mutate(ARR_DELAY_LOG = (ARR_DELAY >= 15 ))

SPRdelay <- DENflights %>% filter(MONTH == "3" | MONTH == "4" | MONTH == "5") %>% group_by(ARR_DELAY_LOG) %>% summarise(count = n()) %>% mutate(total = sum(count))
SPRdelay

SUMdelay <- DENflights %>% filter(MONTH == "6" | MONTH == "7" | MONTH == "8") %>% group_by(ARR_DELAY_LOG) %>% summarise(count = n()) %>% mutate(total = sum(count))
SUMdelay

FALLdelay <- DENflights %>% filter(MONTH == "9" | MONTH == "10" | MONTH == "11") %>% group_by(ARR_DELAY_LOG) %>% summarise(count = n()) %>% mutate(total = sum(count))
FALLdelay

WINdelay <- DENflights %>% filter(MONTH == "12" | MONTH == "1" | MONTH == "2") %>% group_by(ARR_DELAY_LOG) %>% summarise(count = n()) %>% mutate(total = sum(count))
WINdelay
```
Time of year can be a major factor that can effect whether or not a flight may be delayed, due to factors such as weather, school holidays, and major holidays such Christmas. As show in the graph above, there is not a significant amount of discrepancy between the amounts of delayed flights per month, but there are still some apparent and relevant trends. The months with a larger amount of delays are July and December, unsurprising due to the higher number of vacations that happen in the summer, and the large air traffic that comes with the Christmas season. If we break the year down in seasons, there is roughly a 16.8% chance to be delayed during the spring months (March, April, May), a 19.7% chance of being delayed during the summer months (June, July, and August), a 12.1% chance of being delayed during the fall months (September, October, November), and a 19.8% of being delayed during the winter months (December, January, February).


##Probabilities Flights will be Delayed Based on Carrier (Trent)
```{r}
ggplot(DENflights) + geom_point(aes(ARR_DELAY, CARRIER)) + 
  theme_bw() +
  labs(title = 'Total time of delay by carrier',
       subtitle = 'Departure delay',
       xlab='Total time of departure delay',
       ylab='Airline Carrier')
```
```{r}
UAdelay <- DENflights %>% filter(CARRIER == "UA") %>% group_by(ARR_DELAY_LOG) %>% summarise(count = n()) %>% mutate(total = sum(count))
UAdelay

OOdelay <- DENflights %>% filter(CARRIER == "OO") %>% group_by(ARR_DELAY_LOG) %>% summarise(count = n()) %>% mutate(total = sum(count))
OOdelay

VXdelay <- DENflights %>% filter(CARRIER == "VX") %>% group_by(ARR_DELAY_LOG) %>% summarise(count = n()) %>% mutate(total = sum(count))
VXdelay

ASdelay <- DENflights %>% filter(CARRIER == "AS") %>% group_by(ARR_DELAY_LOG) %>% summarise(count = n()) %>% mutate(total = sum(count))
ASdelay
```
Which airline consumers choose to fly on can also be a major factor that can affect if a flight is delayed. From plotting the amount and scale of each carrier's arrival delay, it would seem from the graph that the two airlines with the most and longest delays are UA (United Airlines) and OO (Skywest), and the two airlines with the least delays are VX (Virgin Airlines) and AS (Alaska Airlines). When calculating the probabilities, there is roughly a 12.9% chance of being delayed flying with United, and a 16.0% chance of being delayed on Skywest, the two biggest culprits for tardy flights. However, the probability of being delayed when flying with Virgin is roughly 25.6%, and a 16.9% of being delayed on Alaska. So even though Alaska and Virgin appear to be the airlines with the smaller and least amount of delays, they have a significantly smaller amount of total flights when compared to larger airlines like United and Skywest. This is due to the larger airlines being prone to more extreme outliers and different outcomes, resulting in a larger, more misleading spread of data.

## Team Report
**Trent:** I created the graphs and found the probabilities for the amount of delays over 15 minutes by season and by airline carrier. I used the filter, group_by, summaries, and mutate functions to find the probabilities, and ggplot, specifically geometric point to graph the data. 